apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
commonLabels:
  deployment: fluffy-octo-telegram-grpc-app
  app: fluffy-octo-telegram-grpc-app
resources:
- selfSignedIssuer.yaml
- certificate.yaml
- deployment.yaml
- service.yaml
- configMap.yaml
# - httpProxy.yaml
# - rootProxy.yaml
# - extServer.yaml excluded due to errors with kustomize

images:
- name: ghcr.io/shipperizer/fluffy-octo-telegram-grpc-app
  newTag: v1.0.0
- name: ghcr.io/shipperizer/fluffy-octo-telegram-web-app
  newTag: v1.0.0


patchesJson6902:
- target:
    version: v1
    kind: HTTPProxy
    name: api-shipperizer-org
  patch: |
    - op: add
      path: /spec/includes
      value:
      - name: fluffy-octo-telegram-web-app
        namespace: default
        conditions:
        - prefix: /api/.well-known/jwks.json
